<view class="container image-text-page">
  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="card input-card">
    <view class="input-header">
      <text class="label">è¾“å…¥ä¸»é¢˜</text>
      <text class="hint">AI å°†è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡ˆå¹¶æ¸²æŸ“æˆå›¾ç‰‡</text>
    </view>
    <t-textarea
      class="topic-textarea"
      value="{{topic}}"
      placeholder="ä¾‹å¦‚ï¼šå¦‚ä½•ä¿æŒè‡ªå¾‹ã€æ—©èµ·çš„å¥½å¤„ã€è¯»ä¹¦ç¬”è®°..."
      maxlength="100"
      autosize
      bind:change="onTopicInput"
    />
  </view>

  <!-- æ¨¡æ¿é€‰æ‹© -->
  <view class="section">
    <text class="section-title">é€‰æ‹©æ¨¡æ¿</text>
    <scroll-view scroll-x class="option-scroll" enhanced show-scrollbar="{{false}}">
      <view class="option-list">
        <block wx:for="{{templates}}" wx:key="id">
          <view 
            class="option-item {{selectedTemplate === item.id ? 'selected' : ''}}"
            bindtap="onSelectTemplate"
            data-id="{{item.id}}"
          >
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-name">{{item.name}}</text>
          </view>
        </block>
      </view>
    </scroll-view>
  </view>

  <!-- é£æ ¼é€‰æ‹© -->
  <view class="section">
    <text class="section-title">é€‰æ‹©é£æ ¼</text>
    <view class="tag-list">
      <block wx:for="{{styles}}" wx:key="id">
        <view 
          class="tag-item {{selectedStyle === item.id ? 'selected' : ''}}"
          bindtap="onSelectStyle"
          data-id="{{item.id}}"
        >
          <text>{{item.name}}</text>
        </view>
      </block>
    </view>
  </view>

  <!-- å›¾ç‰‡æ¯”ä¾‹ -->
  <view class="section">
    <text class="section-title">å›¾ç‰‡æ¯”ä¾‹</text>
    <view class="ratio-list">
      <block wx:for="{{ratios}}" wx:key="id">
        <view 
          class="ratio-item {{selectedRatio === item.id ? 'selected' : ''}}"
          bindtap="onSelectRatio"
          data-id="{{item.id}}"
        >
          <text class="ratio-icon">{{item.icon}}</text>
          <text class="ratio-name">{{item.name}}</text>
          <text class="ratio-value">{{item.id}}</text>
        </view>
      </block>
    </view>
  </view>

  <!-- AI æ¨¡å‹é€‰æ‹© -->
  <view class="section">
    <text class="section-title">AI æ¨¡å‹</text>
    <view class="model-list">
      <block wx:for="{{models}}" wx:key="id">
        <view 
          class="model-item {{selectedModel === item.id ? 'selected' : ''}}"
          bindtap="onSelectModel"
          data-id="{{item.id}}"
        >
          <view class="model-info">
            <text class="model-name">{{item.name}}</text>
            <view class="model-quality">
              <text wx:for="{{item.textQuality}}" wx:key="*this" wx:for-item="star">â­</text>
            </view>
          </view>
          <text class="model-desc">{{item.description}}</text>
        </view>
      </block>
    </view>
  </view>

  <!-- ç”ŸæˆæŒ‰é’® -->
  <view class="generate-section">
    <t-button
      class="btn-primary btn-block"
      theme="primary"
      block
      loading="{{loading}}"
      disabled="{{loading || !topic}}"
      bind:tap="onGenerate"
    >
      {{loading ? 'AI ç”Ÿæˆä¸­...' : 'âœ¨ ç”Ÿæˆå›¾æ–‡'}}
    </t-button>
    <text class="generate-tip" wx:if="{{loading}}">ç”Ÿæˆæ—¶é—´çº¦ 10-30 ç§’ï¼Œè¯·è€å¿ƒç­‰å¾…</text>
  </view>

  <!-- ç”Ÿæˆç»“æœ -->
  <view class="result-section" wx:if="{{result}}">
    <view class="result-header">
      <text class="result-title">ç”Ÿæˆç»“æœ</text>
      <view class="result-actions">
        <text class="action-btn" bindtap="onRegenerate">ğŸ”„ é‡æ–°ç”Ÿæˆ</text>
      </view>
    </view>

    <!-- å›¾ç‰‡å±•ç¤º -->
    <view class="image-wrapper" bindtap="onPreviewImage">
      <image 
        class="result-image" 
        src="{{result.imageUrl}}" 
        mode="widthFix"
        show-menu-by-longpress
      />
      <view class="image-overlay">
        <text class="overlay-text">ç‚¹å‡»é¢„è§ˆ</text>
      </view>
    </view>

    <!-- æ–‡æ¡ˆå†…å®¹ -->
    <view class="content-card" wx:if="{{result.content}}">
      <text class="content-title">{{result.content.title}}</text>
      <text class="content-subtitle" wx:if="{{result.content.subtitle}}">{{result.content.subtitle}}</text>
      <view class="content-body">
        <block wx:if="{{result.content.body.constructor === Array}}">
          <view wx:for="{{result.content.body}}" wx:key="index" class="content-item">
            {{index + 1}}. {{item}}
          </view>
        </block>
        <block wx:else>
          <text>{{result.content.body}}</text>
        </block>
      </view>
      <view class="content-tags" wx:if="{{result.content.tags.length}}">
        <text wx:for="{{result.content.tags}}" wx:key="index" class="tag">#{{item}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <t-button
        class="btn-action"
        theme="primary"
        variant="outline"
        icon="download"
        bind:tap="onSave"
      >
        ä¿å­˜å›¾ç‰‡
      </t-button>
      <t-button
        class="btn-action"
        theme="primary"
        open-type="share"
        icon="share"
      >
        åˆ†äº«å¥½å‹
      </t-button>
    </view>
  </view>
</view>
