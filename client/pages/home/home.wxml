<view class="container">
  <!-- ä¸»é¢˜è¾“å…¥å¡ç‰‡ -->
  <view class="card-lg hero-card fade-in">
    <view class="row space-between items-center">
      <text class="section-title" style="margin: 0;">ä¸»é¢˜</text>
      <view class="ai-expand-btn" bindtap="onAiExpand">
        <text class="ai-icon">âœ¨</text>
        <text class="ai-text">AI æ‰©å†™</text>
      </view>
    </view>
    <view class="input-wrapper mt-md">
      <t-input 
        class="topic-input" 
        value="{{topic}}" 
        placeholder="è¾“å…¥ä¸»é¢˜ï¼šå¦‚ æ˜¥æ—¥æ ¡å›­æµ·æŠ¥" 
        maxlength="200"
        borderless 
        bind:change="onTopicInput" 
      />
    </view>
    <text class="muted mt-sm" style="display: block;">å»ºè®® 6-20 ä¸ªå­—ï¼Œæè¿°ä¸»ä½“ + åœºæ™¯ + é£æ ¼</text>
  </view>

  <!-- é£æ ¼é€‰æ‹© -->
  <view class="section-title row space-between">
    <text>é£æ ¼</text>
    <text class="link" bindtap="goStyleLibrary">æŸ¥çœ‹å…¨éƒ¨ â€º</text>
  </view>
  <scroll-view scroll-x class="style-scroll" enhanced show-scrollbar="{{false}}">
    <view class="style-list">
      <block wx:for="{{styles}}" wx:key="id">
        <view 
          class="style-card {{item.selected ? 'selected' : ''}}" 
          bindtap="onSelectStyle" 
          data-id="{{item.id}}"
        >
          <view class="style-cover" style="background: {{item.gradient || 'linear-gradient(135deg, #60A5FA, #93C5FD)'}};">
            <text class="style-icon">{{item.icon}}</text>
          </view>
          <text class="style-name">{{item.name}}</text>
        </view>
      </block>
    </view>
  </scroll-view>

  <!-- æ¨¡å‹é€‰æ‹© -->
  <text class="section-title">æ¨¡å‹</text>
  <view class="card model-card">
    <block wx:for="{{models}}" wx:key="id">
      <view 
        class="model-item {{selectedModel === item.id ? 'selected' : ''}}" 
        bindtap="onSelectModel" 
        data-id="{{item.id}}"
      >
        <view class="model-info">
          <view class="row items-center gap-sm">
            <text class="model-name">{{item.name}}</text>
            <view class="model-badge" wx:if="{{item.badge}}">{{item.badge}}</view>
          </view>
          <text class="model-desc">{{item.desc}}</text>
        </view>
        <view class="model-tags">
          <view class="model-tag price">{{item.price}}</view>
          <view class="model-tag speed">{{item.speed}}</view>
          <view class="model-tag quality">{{item.quality}}</view>
        </view>
        <view class="model-check" wx:if="{{selectedModel === item.id}}">
          <text>âœ“</text>
        </view>
      </view>
    </block>
  </view>

  <!-- é«˜çº§è®¾ç½® -->
  <view class="section-title row space-between" bindtap="toggleAdvanced">
    <text>é«˜çº§è®¾ç½®</text>
    <text class="arrow" style="transform: rotate({{showAdvanced ? 90 : 0}}deg); transition: transform 0.2s;">â€º</text>
  </view>
  <view class="card settings-card" wx:if="{{showAdvanced}}">
    <picker mode="selector" range="{{ratios}}" range-key="label" value="{{ratioIndex}}" bindchange="onRatioChange">
      <view class="setting-row">
        <view class="setting-left">
          <text class="setting-icon">ğŸ“</text>
          <text class="setting-label">å›¾ç‰‡æ¯”ä¾‹</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{ratios[ratioIndex].label}}</text>
          <text class="arrow">â€º</text>
        </view>
      </view>
    </picker>
    <picker mode="selector" range="{{counts}}" range-key="label" value="{{countIndex}}" bindchange="onCountChange">
      <view class="setting-row">
        <view class="setting-left">
          <text class="setting-icon">ğŸ–¼ï¸</text>
          <text class="setting-label">ç”Ÿæˆæ•°é‡</text>
        </view>
        <view class="setting-right">
          <text class="setting-value">{{counts[countIndex].label}}</text>
          <text class="arrow">â€º</text>
        </view>
      </view>
    </picker>
  </view>

  <!-- é¢åº¦æç¤º -->
  <view class="quota-tip mt-lg" wx:if="{{isLoggedIn}}">
    <text class="quota-icon">ğŸ’</text>
    <text class="quota-text">å‰©ä½™é¢åº¦ï¼š{{remainQuota}} æ¬¡</text>
  </view>

  <!-- ç”ŸæˆæŒ‰é’® -->
  <view class="generate-btn-wrapper mt-lg safe-bottom">
    <t-button 
      class="btn-primary btn-block btn-lg" 
      theme="primary" 
      block 
      loading="{{generating}}"
      disabled="{{generating || !topic}}"
      bind:tap="goGenerating"
    >
      {{generating ? 'ç”Ÿæˆä¸­...' : 'ç«‹å³ç”Ÿæˆ'}}
    </t-button>
  </view>
</view>
